/* Upload Page - 100/10 design, above-the-fold */
:root{
  --up-bg: var(--db-bg, #F6F6F7);
  --up-fg: var(--db-fg, #1B1B1F);
  --up-muted: var(--db-muted, #6B7280);
  --up-card: var(--db-card, #FFFFFF);
  --up-accent: var(--db-accent, #4BC3B7);
  --up-accent-soft: var(--db-accent-weak, rgba(75,195,183,.18));
  --up-ring: var(--db-ring, rgba(75,195,183,.35));
  --up-border: #E5E7EB;
  --up-soft: #F9FBFB;
  --up-success: #22C55E;
  --up-error: #B91C1C;

  --up-radius-lg: var(--db-radius, 18px);
  --up-radius: 12px;
  --up-shadow: 0 10px 30px rgba(0,0,0,.06), 0 2px 10px rgba(0,0,0,.04);

  --up-dz-height-desktop: 340px;
  --up-dz-height-mobile: 360px;

  --up-pad-desktop: 24px;
  --up-pad-mobile: 16px;
}

/* Page shell:
 * Previously height:100dvh + overflow:hidden was clipping when content expanded (e.g., errors).
 * Change to min-height + overflow:auto so the outer frame grows naturally.
 */
.up-page[data-page="upload"]{
  min-height: 100dvh;
  background: var(--up-bg);
  color: var(--up-fg);
  display: grid;
  grid-template-rows: auto 1fr;
  padding: calc(env(safe-area-inset-top) + var(--up-pad-mobile))
           var(--up-pad-mobile)
           calc(env(safe-area-inset-bottom) + var(--up-pad-mobile));
  overflow: auto; /* allow growth / scrolling when content expands */
}
@media (min-width: 768px){
  .up-page[data-page="upload"]{
    padding: var(--up-pad-desktop);
  }
}

/* Header */
.up-header{
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: end;
  gap: 12px;
  margin-bottom: 12px;
}
.up-head-text{display:flex;flex-direction:column;align-items:center;text-align:center}
.up-title{margin:0 0 4px;font-weight:800;letter-spacing:-.01em;font-size:clamp(18px,2.2vw,24px)}
.up-subtitle{margin:0;color:var(--up-muted);font-size:13px}

.up-back,.up-help{
  display:inline-flex;align-items:center;gap:8px;text-decoration:none;font-size:14px;
  padding:10px 12px;border-radius:12px;border:1px solid var(--up-accent-soft);
  box-shadow: var(--up-shadow);
  background:#EEF7F6;color:var(--up-fg);
}
.up-help{background:#ffffff80;color:#0b7f76;box-shadow:none}
.up-back:hover{transform:translateY(-1px);transition:transform .16s ease}
.up-help:hover{background:#EEF7F6}
.up-back:focus-visible,.up-help:focus-visible{outline:0;box-shadow:0 0 0 3px var(--up-ring)}

/* Main:
 * let content overflow be visible so the popovers + any error hints can extend.
 */
.up-main{
  display: grid;
  justify-items: center;
  align-content: center;
  gap: 14px;
  height: 100%;
  overflow: visible; /* was hidden; causes outer frame to look stuck */
}

/* Card shell */
.up-card{
  background: var(--up-card);
  border-radius: var(--up-radius-lg);
  border: 1px solid var(--up-accent-soft);
  box-shadow: var(--up-shadow);
}

/* Dropzone */
.up-dz{
  width: min(940px, 100%);
  height: var(--up-dz-height-desktop);
  padding: clamp(18px, 3.6vw, 28px);
  position: relative;
  display: grid;
  place-items: center;
}
@media (max-width: 640px){
  .up-dz{ height: var(--up-dz-height-mobile); }
}

.up-dz-inner{
  width: 100%;
  max-width: 820px;
  height: 100%;
  border: 1.5px dashed rgba(3,105,98,.26);
  border-radius: calc(var(--up-radius-lg) - 6px);
  background: linear-gradient(180deg, #fff, #fbfefd);
  display: grid;
  grid-template-rows: 1fr auto;
  align-items: center;
  justify-items: center;
  padding: clamp(16px, 2.6vw, 24px);
  text-align: center;
  transition: border-color .16s ease, box-shadow .16s ease, transform .16s ease;
}
.up-dz.is-active .up-dz-inner{
  transform: translateY(-2px);
  border-color: rgba(3,105,98,.45);
  box-shadow: 0 0 0 3px var(--up-accent-soft), var(--up-shadow);
}

.up-dz-idle{display:grid;align-content:center;justify-items:center;gap:10px}
.up-icon{width:64px;height:64px;opacity:.95}
.up-h1{margin:0;font-size:clamp(18px,2vw,22px);font-weight:800;letter-spacing:-.01em}
.up-h2{margin:0;color:var(--up-muted);font-size:13.5px}

.up-actions{display:flex;gap:10px;flex-wrap:wrap;justify-content:center}
.up-btn{
  appearance:none;border:1px solid transparent;background:transparent;color:var(--up-fg);
  padding:10px 12px;border-radius:12px;font-size:14px;line-height:1;cursor:pointer;
  display:inline-flex;align-items:center;gap:8px;text-decoration:none;
  transition:transform .16s ease, box-shadow .16s ease, background .16s ease, border-color .16s ease;
}
.up-btn:focus-visible{outline:0;box-shadow:0 0 0 3px var(--up-ring)}
.up-btn:active{transform:translateY(1px)}
.up-btn.primary{background:var(--up-accent);color:#063a37;font-weight:600}
.up-btn.primary:hover{transform:translateY(-1px)}
.up-btn.secondary{background:#EEF7F6;border:1px solid var(--up-accent-soft)}

.up-formats{margin:0;color:var(--up-muted);font-size:12.5px}

/* Progress area shares height with idle */
.up-dz-progress{
  position:absolute; inset: clamp(16px, 2.6vw, 24px);
  display:grid; grid-template-rows:auto 1fr auto; gap:12px;
}
.up-progress-title{margin:0;font-size:15px;font-weight:700}
.up-steps{display:grid;gap:8px;background:var(--up-soft);border:1px solid var(--up-accent-soft);border-radius:12px;padding:10px}
.up-step{
  display:grid;grid-template-columns:24px 1fr auto;gap:10px;align-items:center;
  padding:8px 10px;border-radius:10px;border:1px solid var(--up-accent-soft);background:#fff;
}
.up-step-label{font-size:14px}
.up-step-hint{font-size:12px;color:var(--up-muted)}
.up-pill{font-size:12px;padding:4px 8px;border-radius:999px;border:1px solid var(--up-accent-soft);background:#fff;color:var(--up-muted)}
.up-step--done .up-pill{color:var(--up-success);border-color:rgba(34,197,94,.3)}

.up-bar-wrap{height:8px;border-radius:999px;background:#EEF2F3;border:1px solid #e5e7eb;overflow:hidden}
.up-bar{height:100%;width:0%;border-radius:999px;background:linear-gradient(90deg,var(--up-accent),#8fe1d8);transition:width .28s ease}

.up-success{
  display:flex;align-items:center;justify-content:space-between;gap:12px;
  padding:10px;border-radius:10px;border:1px solid rgba(34,197,94,.28);background:#f3fff8;
}

/* Info chips */
.up-info-row{
  position: relative;
  width: min(940px, 100%);
  display:flex;gap:8px;justify-content:center;align-items:center;
}
.up-chip{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;
  border:1px solid var(--up-accent-soft);background:#fff;font-size:12.5px;color:var(--up-muted);
}
.up-chip svg{opacity:.8}

/* Popover positioned overlay */
.up-pop{position:relative}
.up-pop > summary{list-style:none;cursor:pointer}
.up-pop > summary::-webkit-details-marker{display:none}
.up-pop[open] > summary{outline:0}
.up-pop-panel{
  position:absolute; left:50%; bottom:calc(100% + 8px); transform:translateX(-50%);
  min-width: 240px; max-width: 320px; z-index: 5;
  background:#fff; color:var(--up-fg); border:1px solid var(--up-accent-soft); border-radius:12px; box-shadow:var(--up-shadow);
  padding:10px;
}
.up-pop-title{margin:0 0 6px;font-size:13px;color:var(--up-muted)}
.up-pop-list{margin:0;padding:0;list-style:none;display:grid;gap:6px}
.up-dot{width:8px;height:8px;border-radius:999px;background:var(--up-accent)}
.up-row{display:flex;align-items:center;gap:8px;font-size:12.5px}

@keyframes up-spin{to{transform:rotate(360deg)}}
.up-spin{animation: up-spin 1s linear infinite; transform-origin:center}

/* Hidden input */
.up-visually-hidden{
  position:absolute!important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0 0 0 0);white-space:nowrap;border:0;
}

/* Mobile sticky CTA */
.up-sticky{display:none}
@media (max-width:640px){
  .up-sticky{
    display:grid; position:fixed; left:0; right:0; bottom:0; z-index:10;
    padding:10px 12px calc(10px + env(safe-area-inset-bottom));
    background: linear-gradient(180deg, rgba(246,246,247,0), rgba(246,246,247,0.9) 28%, rgba(246,246,247,1));
    border-top:1px solid var(--up-accent-soft);
  }
  .up-sticky .up-btn{width:100%; justify-content:center}
}